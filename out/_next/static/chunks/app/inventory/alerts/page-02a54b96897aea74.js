(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[829],{1693:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(41342).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},44908:(e,t,s)=>{"use strict";s.d(t,{A:()=>u,AuthProvider:()=>o});var r=s(6012),a=s(18192),l=s(14274),d=s(39368);let i={user:null,store:null,isLoading:!0,isAuthenticated:!1};function n(e,t){switch(t.type){case"SET_LOADING":return{...e,isLoading:t.payload};case"SET_AUTH_DATA":return{...e,user:t.payload.user,store:t.payload.store,isLoading:!1,isAuthenticated:!0};case"CLEAR_AUTH":return{...e,user:null,store:null,isLoading:!1,isAuthenticated:!1};case"SET_ERROR":return{...e,isLoading:!1,error:t.payload};default:return e}}let c=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,a.useReducer)(n,i),u=(0,l.usePathname)();(0,a.useEffect)(()=>{if(["/login","/admin-login","/admin-dashboard"].includes(u)||u.startsWith("/admin-dashboard")){o({type:"SET_LOADING",payload:!1});return}h()},[u]);let h=async()=>{try{let e=await d.ZQ.getMe();if(e.success&&e.data){let t=e.data,s=null;if(t.storeId)try{let e=await fetch("".concat("http://localhost:3001","/store"),{credentials:"include"});if(e.ok){let t=await e.json();t.success&&t.data&&(s=t.data)}}catch(e){console.error("Failed to fetch store data:",e)}o({type:"SET_AUTH_DATA",payload:{user:{id:t.id,email:t.email,role:t.role,storeId:t.storeId},store:s}})}else o({type:"CLEAR_AUTH"})}catch(e){console.error("Auth check failed:",e),o({type:"CLEAR_AUTH"})}},p=async(e,t)=>{try{o({type:"SET_LOADING",payload:!0});let s=await d.ZQ.login(e,t);if(s.success)return o({type:"SET_AUTH_DATA",payload:{user:{id:s.data.user.id,email:s.data.user.email,role:s.data.user.role,storeId:s.data.user.storeId},store:s.data.store}}),{success:!0};return{success:!1,error:s.error}}catch(t){console.error("Login failed:",t);let e=t.message||"Login failed";return o({type:"SET_ERROR",payload:e}),{success:!1,error:e}}finally{o({type:"SET_LOADING",payload:!1})}},m=async()=>{try{await d.ZQ.logout(),o({type:"CLEAR_AUTH"}),window.location.href="/login"}catch(e){console.error("Logout failed:",e),o({type:"CLEAR_AUTH"}),window.location.href="/login"}};return(0,r.jsx)(c.Provider,{value:{state:s,dispatch:o,login:p,logout:m},children:t})}function u(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},60290:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var r=s(6012),a=s(18192),l=s(31564),d=s(50694),i=s(49550),n=s(30487),c=s(64670),o=s(3580),u=s(14408),h=s(77819),p=s(1693),m=s(78703),x=s(28292),f=s(95101),y=s(63230),j=s(96731),v=s(3634);function A(){let{toast:e}=(0,y.dj)(),{state:t}=(0,j.n)(),[s,A]=(0,a.useState)([]),[g,_]=(0,a.useState)(!0),[N,w]=(0,a.useState)(""),[E,R]=(0,a.useState)("unread"),[k,T]=(0,a.useState)(null),[C,S]=(0,a.useState)(!1);(0,a.useEffect)(()=>{L()},[]);let L=async()=>{var s;if(!(null===(s=t.store)||void 0===s?void 0:s.id)){e({title:"Error",description:"Store not selected. Please select a store first.",variant:"destructive"}),_(!1);return}try{_(!0);let s=await fetch("".concat("http://localhost:3001","/inventory/alerts?storeId=").concat(t.store.id),{credentials:"include"}),r=await s.json();r.success?A(r.data):e({title:"Error",description:r.error||"Failed to fetch alerts",variant:"destructive"})}catch(t){e({title:"Error",description:"Failed to fetch alerts",variant:"destructive"})}finally{_(!1)}},D=s.filter(e=>{var t;let s=e.message.toLowerCase().includes(N.toLowerCase())||(null===(t=e.product)||void 0===t?void 0:t.name.toLowerCase().includes(N.toLowerCase())),r=!0;return"unread"===E?r=!e.isRead:"read"===E&&(r=e.isRead),s&&r}),O=s.length,b=s.filter(e=>!e.isRead).length,P=s.filter(e=>"low_stock"===e.type).length,U=s.filter(e=>"out_of_stock"===e.type).length,I=async t=>{e({title:"Info",description:"Mark as read functionality not implemented yet",variant:"default"})},G=async()=>{e({title:"Info",description:"Mark all as read functionality not implemented yet",variant:"default"})},H=e=>{switch(e){case"low_stock":return(0,r.jsx)(o.A,{className:"h-5 w-5 text-yellow-500"});case"out_of_stock":return(0,r.jsx)(u.A,{className:"h-5 w-5 text-red-500"});case"reorder_reminder":return(0,r.jsx)(h.A,{className:"h-5 w-5 text-blue-500"});case"payment_failed":case"order_cancelled":return(0,r.jsx)(o.A,{className:"h-5 w-5 text-red-500"});default:return(0,r.jsx)(o.A,{className:"h-5 w-5 text-gray-500"})}},M=e=>{switch(e){case"low_stock":return"warning";case"out_of_stock":case"payment_failed":case"order_cancelled":return"destructive";case"reorder_reminder":return"default";default:return"secondary"}},B=e=>{switch(e){case"low_stock":return"Low Stock";case"out_of_stock":return"Out of Stock";case"reorder_reminder":return"Reorder Reminder";case"payment_failed":return"Payment Failed";case"order_cancelled":return"Order Cancelled";default:return e}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(x.B,{actions:[{label:"Mark All as Read",icon:p.A,variant:"outline",onClick:G}]}),(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Inventory Alerts"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage and view inventory-related alerts and notifications."}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsx)(f.f,{title:"Total Alerts",value:O,description:"All inventory alerts",icon:o.A}),(0,r.jsx)(f.f,{title:"Unread Alerts",value:b,description:"Need attention",icon:o.A,badge:b>0?{text:"New",variant:"destructive"}:void 0}),(0,r.jsx)(f.f,{title:"Low Stock",value:P,description:"Items need restocking",icon:o.A}),(0,r.jsx)(f.f,{title:"Out of Stock",value:U,description:"Items unavailable",icon:u.A,badge:U>0?{text:"Critical",variant:"destructive"}:void 0})]}),(0,r.jsxs)(l.Zp,{className:"rounded-sm",children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Alert Filters"}),(0,r.jsx)(l.BT,{children:"Filter alerts by type and search"})]}),(0,r.jsx)(l.Wu,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,r.jsx)(i.p,{placeholder:"Search alerts...",value:N,onChange:e=>w(e.target.value),className:"pl-10"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(d.$,{variant:"all"===E?"default":"outline",size:"sm",onClick:()=>R("all"),children:["All (",O,")"]}),(0,r.jsxs)(d.$,{variant:"unread"===E?"default":"outline",size:"sm",onClick:()=>R("unread"),children:["Unread (",b,")"]}),(0,r.jsxs)(d.$,{variant:"read"===E?"default":"outline",size:"sm",onClick:()=>R("read"),children:["Read (",O-b,")"]})]})]})})]}),(0,r.jsxs)(l.Zp,{className:"rounded-sm",children:[(0,r.jsxs)(l.aR,{children:[(0,r.jsx)(l.ZB,{children:"Inventory Alerts"}),(0,r.jsx)(l.BT,{children:"List of all inventory alerts and notifications"})]}),(0,r.jsx)(l.Wu,{children:g?(0,r.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,t)=>(0,r.jsx)("div",{className:"h-16 bg-muted rounded animate-pulse"},t))}):0===D.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(o.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium",children:"No alerts found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"unread"===E?"No unread alerts.":"No alerts match your filters."})]}):(0,r.jsx)("div",{className:"space-y-4",children:D.map(e=>(0,r.jsx)("div",{className:"p-4 border rounded-lg ".concat(e.isRead?"bg-muted/50":"bg-background"),children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[H(e.type),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,r.jsx)(n.E,{variant:M(e.type),children:B(e.type)}),!e.isRead&&(0,r.jsx)(n.E,{variant:"default",children:"New"})]}),(0,r.jsx)("p",{className:"text-sm",children:e.message}),e.product&&(0,r.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:[(0,r.jsxs)("p",{children:["Product: ",e.product.name]}),(0,r.jsxs)("p",{children:["Current Stock: ",e.product.stock," units"]}),(0,r.jsxs)("p",{children:["Threshold: ",e.product.lowStockThreshold," units"]})]}),(0,r.jsxs)("p",{className:"mt-2 text-xs text-muted-foreground",children:["Created: ",new Date(e.createdAt).toLocaleString()]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[!e.isRead&&(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>I(e.id),children:(0,r.jsx)(p.A,{className:"h-4 w-4"})}),(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>{T(e),S(!0)},children:"View Details"})]})]})},e.id))})})]}),(0,r.jsx)(v.lG,{open:C,onOpenChange:S,children:(0,r.jsxs)(v.Cf,{children:[(0,r.jsxs)(v.c7,{children:[(0,r.jsx)(v.L3,{children:"Alert Details"}),(0,r.jsx)(v.rr,{children:"Detailed information about the inventory alert"})]}),k&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[H(k.type),(0,r.jsx)(n.E,{variant:M(k.type),children:B(k.type)}),(0,r.jsx)(n.E,{variant:k.isRead?"secondary":"default",children:k.isRead?"Read":"Unread"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{children:"Message"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:k.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(c.J,{children:"Created At"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(k.createdAt).toLocaleString()})]}),k.product&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(c.J,{children:"Product Information"}),(0,r.jsxs)("div",{className:"text-sm space-y-1",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Name:"})," ",k.product.name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Current Stock:"})," ",k.product.stock," units"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Low Stock Threshold:"})," ",k.product.lowStockThreshold," units"]})]})]})]}),(0,r.jsxs)(v.Es,{children:[!(null==k?void 0:k.isRead)&&(0,r.jsx)(d.$,{onClick:()=>{k&&I(k.id),S(!1)},children:"Mark as Read"}),(0,r.jsx)(d.$,{variant:"outline",onClick:()=>S(!1),children:"Close"})]})]})})]})}},73819:(e,t,s)=>{Promise.resolve().then(s.bind(s,60290))},77819:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(41342).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},96731:(e,t,s)=>{"use strict";s.d(t,{AppProvider:()=>c,n:()=>o});var r=s(6012),a=s(18192),l=s(44908);let d={store:null,products:[],orders:[],currentOrder:null,isLoading:!1,error:null,sidebarCollapsed:!1};function i(e,t){switch(t.type){case"SET_LOADING":return{...e,isLoading:t.payload};case"SET_ERROR":return{...e,error:t.payload};case"SET_PRODUCTS":return{...e,products:t.payload};case"ADD_PRODUCT":return{...e,products:[...e.products,t.payload]};case"UPDATE_PRODUCT":return{...e,products:e.products.map(e=>e.id===t.payload.id?t.payload:e)};case"DELETE_PRODUCT":return{...e,products:e.products.filter(e=>e.id!==t.payload)};case"SET_ORDERS":return{...e,orders:t.payload};case"ADD_ORDER":return{...e,orders:[...e.orders,t.payload]};case"UPDATE_ORDER":return{...e,orders:e.orders.map(e=>e.id===t.payload.id?t.payload:e)};case"SET_CURRENT_ORDER":return{...e,currentOrder:t.payload};case"TOGGLE_SIDEBAR":return{...e,sidebarCollapsed:!e.sidebarCollapsed};case"UPDATE_STOCK":return{...e,products:e.products.map(e=>e.id===t.payload.productId?{...e,stock:t.payload.newStock}:e)};case"UPDATE_STORE":return{...e,store:t.payload};default:return e}}let n=(0,a.createContext)(void 0);function c(e){let{children:t}=e,{state:s}=(0,l.A)(),[c,o]=(0,a.useReducer)(i,d);return(0,a.useEffect)(()=>{s.store&&o({type:"UPDATE_STORE",payload:s.store})},[s.store]),(0,r.jsx)(n.Provider,{value:{state:c,dispatch:o},children:t})}function o(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useApp must be used within an AppProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[863,372,334,573,379,746,847,358],()=>t(73819)),_N_E=e.O()}]);